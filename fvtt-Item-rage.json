{
  "name": "Rage",
  "type": "feat",
  "img": "icons/creatures/abilities/mouth-teeth-human.webp",
  "data": {
    "description": {
      "value": "<p>In battle, you fight with primal ferocity. On your turn, you can enter a rage as a bonus action. While raging, you gain the following benefits if you aren't wearing heavy armor:</p>\n<ul>\n<li>\n<p>You have advantage on Strength checks and Strength saving throws.</p>\n</li>\n<li>\n<p>When you make a melee weapon attack using Strength, you gain a bonus to the damage roll that increases as you gain levels as a barbarian, as shown in the Rage Damage column of the Barbarian table.</p>\n</li>\n<li>\n<p>You have resistance to bludgeoning, piercing, and slashing damage.</p>\n</li>\n</ul>\n<p>If you are able to cast spells, you can't cast them or concentrate on them while raging. </p>\n<p>Your rage lasts for 1 minute. It ends early if you are knocked unconscious or if your turn ends and you haven't attacked a hostile creature since your last turn or taken damage since then. You can also end your rage on your turn as a bonus action. </p>\n<p>Once you have raged the number of times shown for your barbarian level in the Rages column in the table below, you must finish a long rest before you can rage again.</p>\n<p><em style=\"box-sizing:border-box;user-select:text;color:#191813;font-size:13px\">**Foundry note: Note the limited uses is set to the base default of 2. Please manually adjust as required.</em></p>\n<table style=\"width:286px;height:170px\" border=\"1\">\n<tbody>\n<tr style=\"height:17px\">\n<td style=\"width:112px;height:17px\"><strong>Barbarian Level</strong></td>\n<td style=\"width:68px;height:17px\"><strong>Rages</strong></td>\n<td style=\"width:96px;height:17px\"><strong>Rage Damage</strong></td>\n</tr>\n<tr style=\"height:17px\">\n<td style=\"width:112px;height:17px\">1st</td>\n<td style=\"width:68px;height:17px\">2</td>\n<td style=\"width:96px;height:17px\">+2</td>\n</tr>\n<tr style=\"height:17px\">\n<td style=\"width:112px;height:17px\">2nd</td>\n<td style=\"width:68px;height:17px\">2</td>\n<td style=\"width:96px;height:17px\">+2</td>\n</tr>\n<tr style=\"height:17px\">\n<td style=\"width:112px;height:17px\">3rd</td>\n<td style=\"width:68px;height:17px\">3</td>\n<td style=\"width:96px;height:17px\">+2</td>\n</tr>\n<tr style=\"height:17px\">\n<td style=\"width:112px;height:17px\">4th</td>\n<td style=\"width:68px;height:17px\">3</td>\n<td style=\"width:96px;height:17px\">+2</td>\n</tr>\n<tr style=\"height:17px\">\n<td style=\"width:112px;height:17px\">5th</td>\n<td style=\"width:68px;height:17px\">3</td>\n<td style=\"width:96px;height:17px\">+2</td>\n</tr>\n<tr style=\"height:17px\">\n<td style=\"width:112px;height:17px\">6th</td>\n<td style=\"width:68px;height:17px\">4</td>\n<td style=\"width:96px;height:17px\">+2</td>\n</tr>\n<tr style=\"height:17px\">\n<td style=\"width:112px;height:17px\">7th</td>\n<td style=\"width:68px;height:17px\">4</td>\n<td style=\"width:96px;height:17px\">+2</td>\n</tr>\n<tr>\n<td style=\"width:112px\">8th</td>\n<td style=\"width:68px\">4</td>\n<td style=\"width:96px\">+2</td>\n</tr>\n<tr>\n<td style=\"width:112px\">9th</td>\n<td style=\"width:68px\">4</td>\n<td style=\"width:96px\">+3</td>\n</tr>\n<tr>\n<td style=\"width:112px\">10th</td>\n<td style=\"width:68px\">4</td>\n<td style=\"width:96px\">+3</td>\n</tr>\n<tr>\n<td style=\"width:112px\">11th</td>\n<td style=\"width:68px\">4</td>\n<td style=\"width:96px\">+3</td>\n</tr>\n<tr>\n<td style=\"width:112px\">12th</td>\n<td style=\"width:68px\">5</td>\n<td style=\"width:96px\">+3</td>\n</tr>\n<tr>\n<td style=\"width:112px\">13th</td>\n<td style=\"width:68px\">5</td>\n<td style=\"width:96px\">+3</td>\n</tr>\n<tr>\n<td style=\"width:112px\">14th</td>\n<td style=\"width:68px\">5</td>\n<td style=\"width:96px\">+3</td>\n</tr>\n<tr style=\"height:17px\">\n<td style=\"width:112px;height:17px\">15th</td>\n<td style=\"width:68px;height:17px\">5</td>\n<td style=\"width:96px;height:17px\">+3</td>\n</tr>\n<tr style=\"height:17px\">\n<td style=\"width:112px;height:17px\">16th</td>\n<td style=\"width:68px;height:17px\">5</td>\n<td style=\"width:96px;height:17px\">+4</td>\n</tr>\n<tr>\n<td style=\"width:112px\">17th</td>\n<td style=\"width:68px\">6</td>\n<td style=\"width:96px\">+4</td>\n</tr>\n<tr>\n<td style=\"width:112px\">18th</td>\n<td style=\"width:68px\">6</td>\n<td style=\"width:96px\">+4</td>\n</tr>\n<tr style=\"height:17px\">\n<td style=\"width:112px;height:17px\">19th</td>\n<td style=\"width:68px;height:17px\">6</td>\n<td style=\"width:96px;height:17px\">+4</td>\n</tr>\n<tr style=\"height:17px\">\n<td style=\"width:112px;height:17px\">20th</td>\n<td style=\"width:68px;height:17px\">Unlimited</td>\n<td style=\"width:96px;height:17px\">+4</td>\n</tr>\n</tbody>\n</table>\n<p> </p>",
      "chat": "",
      "unidentified": ""
    },
    "source": "PHB pg. 48",
    "activation": {
      "type": "bonus",
      "cost": 1,
      "condition": ""
    },
    "duration": {
      "value": 1,
      "units": "minute"
    },
    "target": {
      "value": null,
      "width": null,
      "units": "",
      "type": "self"
    },
    "range": {
      "value": null,
      "long": null,
      "units": "self"
    },
    "uses": {
      "value": 4,
      "max": "4",
      "per": "lr",
      "type": "lr"
    },
    "consume": {
      "type": "",
      "target": "",
      "amount": null
    },
    "ability": "",
    "actionType": "other",
    "attackBonus": 0,
    "chatFlavor": "",
    "critical": {
      "threshold": null,
      "damage": null
    },
    "damage": {
      "parts": [],
      "versatile": "",
      "value": ""
    },
    "formula": "",
    "save": {
      "ability": "",
      "dc": null,
      "scaling": "spell",
      "value": ""
    },
    "requirements": "Barbarian 1",
    "recharge": {
      "value": null,
      "charged": false
    },
    "armor": {
      "value": 10
    },
    "hp": {
      "value": 0,
      "max": 0,
      "dt": null,
      "conditions": ""
    },
    "properties": {
      "amm": false,
      "fin": false,
      "fir": false,
      "foc": false,
      "hvy": false,
      "lgt": false,
      "lod": false,
      "rch": false,
      "rel": false,
      "ret": false,
      "spc": false,
      "thr": false,
      "two": false,
      "ver": false
    },
    "price": null,
    "attunement": 0
  },
  "effects": [
    {
      "_id": "ob3w64kffx6zazhc",
      "changes": [
        {
          "key": "macro.itemMacro",
          "mode": 0,
          "value": "@item",
          "priority": "20"
        },
        {
          "key": "data.bonuses.mwak.damage",
          "mode": 2,
          "value": "((floor(abs((@classes.barbarian.levels)-2)/7))+2)",
          "priority": "20"
        },
        {
          "key": "data.traits.dr.value",
          "mode": 2,
          "value": "bludgeoning",
          "priority": "20"
        },
        {
          "key": "data.traits.dr.value",
          "mode": 2,
          "value": "piercing",
          "priority": "20"
        },
        {
          "key": "data.traits.dr.value",
          "mode": 2,
          "value": "slashing",
          "priority": "20"
        },
        {
          "key": "flags.midi-qol.advantage.ability.check.str",
          "mode": 0,
          "value": "1",
          "priority": "20"
        },
        {
          "key": "flags.midi-qol.advantage.ability.save.str",
          "mode": 0,
          "value": "1",
          "priority": "20"
        }
      ],
      "disabled": false,
      "duration": {
        "startTime": null,
        "rounds": 10
      },
      "icon": "icons/creatures/abilities/mouth-teeth-human.webp",
      "label": "Rage",
      "transfer": false,
      "flags": {
        "core": {
          "statusId": ""
        },
        "dae": {
          "stackable": "none",
          "durationExpression": "",
          "macroRepeat": "none",
          "specialDuration": [],
          "transfer": false
        },
        "dnd5e-helpers": {
          "rest-effect": "Ignore"
        },
        "ActiveAuras": {
          "isAura": false,
          "aura": "None",
          "radius": null,
          "alignment": "",
          "type": "",
          "ignoreSelf": false,
          "height": false,
          "hidden": false,
          "displayTemp": false,
          "hostile": false,
          "onlyOnce": false
        }
      },
      "tint": null,
      "selectedKey": [
        "macro.itemMacro",
        "data.bonuses.mwak.damage",
        "data.traits.dr.value",
        "data.traits.dr.value",
        "data.traits.dr.value",
        "flags.midi-qol.advantage.ability.check.str",
        "flags.midi-qol.advantage.ability.save.str"
      ]
    }
  ],
  "flags": {
    "core": {
      "sourceId": "Item.C2lYHOGH2UpEifk7"
    },
    "exportSource": {
      "world": "Rime-of-the-Frost-Maiden",
      "system": "dnd5e",
      "coreVersion": "9.269",
      "systemVersion": "1.6.0"
    },
    "magicitems": {
      "enabled": false,
      "equipped": false,
      "attuned": false,
      "charges": "0",
      "chargeType": "c1",
      "destroy": false,
      "destroyFlavorText": "reaches 0 charges: it crumbles into ashes and is destroyed.",
      "rechargeable": false,
      "recharge": "0",
      "rechargeType": "t1",
      "rechargeUnit": "r1",
      "sorting": "l"
    },
    "itemacro": {
      "macro": {
        "data": {
          "_id": null,
          "name": "Rage",
          "type": "script",
          "author": "jM4h8qpyxwTpfNli",
          "img": "icons/svg/dice-target.svg",
          "scope": "global",
          "command": "// throat clearing to get data on token\nconst lastArg = args[args.length - 1];\nlet tokenD;\nif (lastArg.tokenId) tokenD = canvas.tokens.get(lastArg.tokenId).actor;\nelse tokenD = game.actors.get(lastArg.actorId);\nlet item = args[1]; //passed by @item in the DAE field\nlet level = tokenD.data.data.classes.barbarian.levels;\nif (!level) {\n  ui.notifications.warn(\"You are not a barbarian!\");\n  return;\n}\nlet subClass = tokenD.data.data.classes.barbarian.subclass.identifier;\nlet name = tokenD.data.token.name;\nlet mod = tokenD.data.data.abilities.str.mod;\nlet mgcProp = \"\";\nif (level > 5) {\n  mgcProp = true;\n}\n\nconsole.log(\"tokenD: \", tokenD)\nconsole.log(\"item: \", item)\nconsole.log(\"level: \", level)\nconsole.log(\"subClass: \", subClass)\nconsole.log(\"name: \", name)\nconsole.log(\"mod: \", mod)\nconsole.log(\"mgcProp: \", mgcProp)\n\nif (args[0] === \"on\") {\n  // Mesages for when your barbarian gets angry. Feel free to customize.\n  let biteMsg = name + \" grows fierce, snarly teeth!\";\n  let clawMsg = name + \" grows sharp, slashing claws!\";\n  let tailMsg = name + \" grows a long, swinging tail!\";\n  let rageMsg = name + \" is ... RAGING!\";\n\n  // Define weapon if no weapon will be chosen later.\n  let weapon = \"\";\n\n  const animation = async () => {\n    new Sequence()\n      .effect()\n      .file(\"jb2a.markers.02.pink\") // patreon version\n      .atLocation(tokenD)\n      .duration(3000)\n      .fadeIn(500)\n      .fadeOut(500)\n      .scale(0.75)\n      .waitUntilFinished(-500)\n\n      .effect()\n      .file(\"jb2a.impact.purple.1\") // patreon version\n      .atLocation(tokenD)\n      .fadeIn(100)\n      .fadeOut(200)\n      .waitUntilFinished(-500)\n      .scale(0.75)\n\n      .effect()\n      .file(\"jb2a.impact.011.dark_purple\") // patreon version\n      .atLocation(tokenD)\n      .fadeIn(500)\n      .fadeOut(500)\n      .scale(0.75)\n      .waitUntilFinished(-500)\n      .play();\n  };\n\n  async function animationEnd() {\n    Sequencer.EffectManager.endEffects({\n      name: `${item.actor.data.name}- Rage -${token.data._id}`,\n    }); //When we revert the mutation, we'll call this function to dismiss the animation\n  }\n\n  let mCallbacks = {\n    post: animation, //Straight after the mutation, we want to execute this animation function as a callback\n  };\n\n  function condition(eventData) {\n    console.log(token.id, eventData.actorData.token);\n    console.log(token.id === eventData.actorData.token._id);\n    return token.id === eventData.actorData.token._id; //This condition makes sure we have the correct token to revert the mutation from\n  }\n\n  // Define the weapons\n  let bite = {\n    name: \"Form of the Beast: Bite\",\n    type: \"weapon\",\n    img: \"icons/creatures/abilities/mouth-teeth-long-red.webp\",\n    data: {\n      description: {\n        value:\n          \"<p><strong>Bite.</strong> Your mouth transforms into a bestial muzzle or great mandibles (your choice). It deals 1d8 + 4 piercing damage on a hit. Once on each of your turns when you damage a creature with this bite, you regain a number of hit points equal to your proficiency bonus, provided you have fewer than half your hit points when you hit.</p>\",\n      },\n      quantity: 1,\n      weight: 0,\n      price: 0,\n      attunement: 0,\n      equipped: true,\n      identified: true,\n      activation: {\n        type: \"action\",\n        cost: 1,\n      },\n      target: {\n        value: 1,\n        width: null,\n        units: \"\",\n        type: \"creature\",\n      },\n      range: {\n        value: 5,\n        long: null,\n        units: \"ft\",\n      },\n      actionType: \"mwak\",\n      damage: {\n        parts: [[\"1d8[piercing]+@mod\", \"piercing\"]],\n      },\n      weaponType: \"natural\",\n      properties: {\n        mgc: `${mgcProp}`,\n      },\n      proficient: true,\n    },\n    effects: [\n      {\n        _id: \"SwjTdomYq58tha05\",\n        changes: [\n          {\n            key: \"flags.dnd5e.DamageBonusMacro\",\n            mode: 0,\n            value: \"ItemMacro.Form of the Beast: Bite\",\n            priority: \"20\",\n          },\n        ],\n        disabled: false,\n        duration: {\n          startTime: null,\n        },\n        icon: \"icons/creatures/abilities/mouth-teeth-long-red.webp\",\n        label: \"Beast Bite\",\n        origin: \"Item.rauFpreQtKHaqkd7\",\n        tint: \"\",\n        transfer: true,\n        flags: {\n          core: {\n            statusId: \"\",\n          },\n          dae: {\n            stackable: \"none\",\n            durationExpression: \"\",\n            macroRepeat: \"none\",\n            specialDuration: [],\n            transfer: true,\n          },\n          ActiveAuras: {\n            isAura: false,\n            aura: \"None\",\n            radius: null,\n            alignment: \"\",\n            type: \"\",\n            ignoreSelf: false,\n            height: false,\n            hidden: false,\n            displayTemp: false,\n            hostile: false,\n            onlyOnce: false,\n          },\n          \"dnd5e-helpers\": {\n            \"rest-effect\": \"Ignore\",\n          },\n        },\n        selectedKey: \"flags.dnd5e.DamageBonusMacro\",\n      },\n    ],\n    flags: {\n      favtab: {\n        isFavorite: true,\n      },\n      midiProperties: {\n        magicdam: `${mgcProp}`,\n      },\n      itemacro: {\n        macro: {\n          data: {\n            _id: null,\n            name: \"Form of the Beast: Bite\",\n            type: \"script\",\n            author: \"jM4h8qpyxwTpfNli\",\n            img: \"icons/svg/dice-target.svg\",\n            scope: \"global\",\n            command:\n              '/*****\\nForm of the Beast: Bite\\n\\nUSEAGE : AUTOMATED\\nThis item should be placed on the character that has Psionic Power: Psychic Whispers\\n\\nYour mouth transforms into a bestial muzzle or great mandibles (your choice). It deals 1d8 piercing damage on a hit. Once on each of your turns when you damage a creature with this bite, you regain a number of hit points equal to your proficiency bonus, provided you have less than half your hit points when you hit.\\n\\nv0.1 April 25 2022 jbowens #0415 (Discord) https://github.com/jbowensii/More-Automated-Spells-Items-and-Feats.git\\n*****/\\n// who\\'s who?\\nconst thisItem = await fromUuid(args[0].itemUuid);\\nconst pcToken = token;\\nconst pcActor = token.actor;\\n\\n// check character current hp > 1/2 max hp return\\nconst halfHP = actor.data.data.attributes.hp.max / 2;\\nconst currentHP = actor.data.data.attributes.hp.value;\\n\\nif (currentHP >= halfHP) return;\\n\\n// test and set combat flag for use once per round if in combat\\nif (game.combat) {\\n  const combatTime = `${game.combat.id}-${\\n    game.combat.round + game.combat.turn / 100\\n  }`;\\n\\n  console.log(\"combatTime:\", combatTime);\\n\\n  const lastTime = actor.getFlag(\"midi-qol\", \"beastBite\");\\n  if (combatTime === lastTime) return;\\n  // already used Beast Bite this round return\\n  else await actor.setFlag(\"midi-qol\", \"beastBite\", combatTime);\\n}\\n\\n// get character proficiency bonus and heal that amount\\nconst healAmount = actor.data.data.attributes.prof;\\nawait MidiQOL.applyTokenDamage(\\n  [{ damage: healAmount, type: \"healing\" }],\\n  healAmount,\\n  new Set([pcToken]),\\n  thisItem,\\n  new Set()\\n);\\n\\nreturn;',\n            folder: null,\n            sort: 0,\n            permission: {\n              default: 0,\n            },\n            flags: {},\n          },\n        },\n      },\n      core: {\n        sourceId: \"Item.rauFpreQtKHaqkd7\",\n      },\n    },\n  };\n  let claws = {\n    name: \"Form of the Beast: Claws\",\n    type: \"weapon\",\n    img: \"icons/commodities/claws/claws-white.webp\",\n    data: {\n      description: {\n        value:\n          \"<p><strong>Claws.</strong> Each of your hands transforms into a claw, which you can use as a weapon if it’s empty. It deals 1d6 + \" +\n          `${mod}` +\n          \" slashing damage on a hit. Once on each of your turns when you attack with a claw using the Attack action, you can make one additional claw attack as part of the same action.</p>\",\n      },\n      quantity: 1,\n      weight: 0,\n      price: 0,\n      attunement: 0,\n      equipped: true,\n      identified: true,\n      activation: {\n        type: \"action\",\n        cost: 1,\n      },\n      target: {\n        value: 1,\n        type: \"creature\",\n      },\n      range: {\n        value: 5,\n        units: \"ft\",\n      },\n      actionType: \"mwak\",\n      attackBonus: \"0\",\n      damage: {\n        parts: [[\"1d6[slashing]+@mod\", \"slashing\"]],\n      },\n      weaponType: \"natural\",\n      properties: {\n        mgc: `${mgcProp}`,\n      },\n      proficient: true,\n    },\n    flags: {\n      favtab: {\n        isFavorite: true,\n      },\n      midiProperties: {\n        magicdam: `${mgcProp}`,\n      },\n    },\n  };\n  let tail = {\n    name: \"Form of the Beast: Tail\",\n    type: \"weapon\",\n    img: \"icons/commodities/biological/tail-puff-grey.webp\",\n    data: {\n      description: {\n        value:\n          \"<p><strong>Tail.</strong> You grow a lashing, spiny tail, which deals 1d8 + \" +\n          `${mod}` +\n          \" piercing damage on a hit and has the reach property.</p>\",\n      },\n      quantity: 1,\n      weight: 0,\n      price: 0,\n      attunement: 0,\n      equipped: true,\n      identified: true,\n      activation: {\n        type: \"action\",\n        cost: 1,\n      },\n      target: {\n        value: 1,\n        type: \"creature\",\n      },\n      range: {\n        value: 10,\n        units: \"ft\",\n      },\n      actionType: \"mwak\",\n      attackBonus: \"0\",\n      damage: {\n        parts: [[\"1d8[piercing]+@mod\", \"piercing\"]],\n      },\n      weaponType: \"natural\",\n      properties: {\n        mgc: `${mgcProp}`,\n        rch: true,\n      },\n      proficient: true,\n    },\n    flags: {\n      favtab: {\n        isFavorite: true,\n      },\n      midiProperties: {\n        magicdam: `${mgcProp}`,\n      },\n    },\n  };\n  let tailSwipe = {\n    name: \"Form of the Beast: Tail Swipe\",\n    type: \"weapon\",\n    img: \"icons/commodities/biological/tail-puff-grey.webp\",\n    data: {\n      description: {\n        value:\n          \"<p><strong>Tail Swipe.</strong>If a creature you can see within 10 feet of you hits you with an attack roll, you can use your reaction to swipe your tail and roll a d8, applying a bonus to your AC equal to the number rolled, potentially causing the attack to miss you.</p>\",\n      },\n      quantity: 1,\n      weight: 0,\n      price: 0,\n      attunement: 0,\n      equipped: true,\n      identified: true,\n      activation: {\n        type: \"reaction\",\n        cost: 1,\n      },\n      target: {\n        type: \"self\",\n      },\n      range: {\n        units: \"self\",\n      },\n      weaponType: \"natural\",\n      properties: {\n        mgc: `${mgcProp}`,\n      },\n      proficient: true,\n    },\n    effects: [\n      {\n        changes: [\n          {\n            key: \"data.attributes.ac.bonus\",\n            mode: 2,\n            value: \"[[+1d8]]\",\n            priority: \"20\",\n          },\n        ],\n        icon: \"systems/dnd5e/icons/items/inventory/monster-tail.jpg\",\n        label: \"Form of the Beast: Tail Swipe\",\n        flags: {\n          dae: {\n            specialDuration: [\"1Reaction\"],\n            transfer: false,\n            stackable: \"none\",\n            durationExpression: \"\",\n            macroRepeat: \"none\",\n          },\n          \"dnd5e-helpers\": {\n            \"rest-effect\": \"Ignore\",\n          },\n        },\n        selectedKey: \"data.attributes.ac.bonus\",\n        _id: \"o5kga2qd35cjz78v\",\n        disabled: false,\n        duration: {\n          startTime: null,\n        },\n        transfer: false,\n        tint: null,\n      },\n    ],\n    flags: {\n      favtab: {\n        isFavorite: true,\n      },\n    },\n  };\n\n  // Check if correct subclass is in place\n  if (subClass == \"path-of-the-beast\") {\n    const buttonData = {\n      buttons: [\n        {\n          label:\n            \"<a title='Your mouth transforms into a bestial muzzle or great mandibles (your choice). It deals 1d8 piercing damage on a hit. Once on each of your turns when you damage a creature with this bite, you regain a number of hit points equal to your proficiency bonus, provided you have less than half your hit points when you hit.' alt='Your mouth transforms into a bestial muzzle or great mandibles (your choice). It deals 1d8 piercing damage on a hit. Once on each of your turns when you damage a creature with this bite, you regain a number of hit points equal to your proficiency bonus, provided you have less than half your hit points when you hit.'>Bite</a>\",\n          value: {\n            msg: biteMsg,\n            update: {\n              embedded: {\n                Item: {\n                  [bite.name]: bite,\n                },\n              },\n            },\n          },\n        },\n        {\n          label:\n            \"<a title='Each of your hands transforms into a claw, which you can use as a weapon if it’s empty. It deals 1d6 slashing damage on a hit. Once on each of your turns when you attack with a claw using the Attack action, you can make one additional claw attack as part of the same action.' alt='Each of your hands transforms into a claw, which you can use as a weapon if it’s empty. It deals 1d6 slashing damage on a hit. Once on each of your turns when you attack with a claw using the Attack action, you can make one additional claw attack as part of the same action.'>Claws</a>\",\n          value: {\n            msg: clawMsg,\n            update: {\n              embedded: {\n                Item: {\n                  [claws.name]: claws,\n                },\n              },\n            },\n          },\n        },\n        {\n          label:\n            \"<a title='You grow a lashing, spiny tail, which deals 1d8 piercing damage on a hit and has the reach property. If a creature you can see within 10 feet of you hits you with an attack roll, you can use your reaction to swipe your tail and roll a d8, applying a bonus to your AC equal to the number rolled, potentially causing the attack to miss you.' alt='You grow a lashing, spiny tail, which deals 1d8 piercing damage on a hit and has the reach property. If a creature you can see within 10 feet of you hits you with an attack roll, you can use your reaction to swipe your tail and roll a d8, applying a bonus to your AC equal to the number rolled, potentially causing the attack to miss you.'>Tail</a>\",\n          value: {\n            msg: tailMsg,\n            update: {\n              embedded: {\n                Item: {\n                  [tail.name]: tail,\n                  [tailSwipe.name]: tailSwipe,\n                },\n              },\n            },\n          },\n        },\n      ],\n      title: \"Which Form of the Beast?\",\n      content: `<p><img src=\"https://www.dndbeyond.com/avatars/thumbnails/13710/613/420/618/637402706646069197.png\" height=\"100\" style=\"float:left;outline:0;border:0;vertical-align:middle;margin:0px 10px\">When you enter your rage, you can transform, revealing the bestial power within you. Until the rage ends, you manifest a natural weapon. It counts as a simple melee weapon for you, and you add your Strength modifier to the attack and damage rolls when you attack with it, as normal.</p>\n    <p>You choose the weapon’s form each time you rage:</p>`,\n    };\n    weapon = await warpgate.buttonDialog(buttonData);\n  }\n\n  const options = {\n    comparisonKeys: { ActiveEffect: \"label\" },\n    name: \"Rage\", //Let's give the mutation a name so when we shift-click the revert button, we'll identify the right mutation to revert\n  };\n\n  // send fun message about weapons if available\n  if (weapon.msg) {\n    ui.notifications.info(weapon.msg);\n  } else {\n    ui.notifications.info(rageMsg);\n  }\n\n  // merge updates for spawning\n  let updates = weapon.update;\n  // let updates = mergeObject(rageAE, weapon.update); << old version\n\n  await warpgate.mutate(token.document, updates, mCallbacks, options); //Let's mutate the token document with some updates(stats changes and active effect on), callbacks(animation function) and options(name).\n}\n\nif (args[0] === \"off\") {\n  warpgate.revert(token.document, \"Rage\");\n}",
          "folder": null,
          "sort": 0,
          "permission": {
            "default": 0
          },
          "flags": {}
        }
      }
    },
    "favtab": {
      "isFavorite": true
    },
    "spellTemplateManager": {
      "stmData": {
        "ignoreDuration": false,
        "spellTexture": "",
        "useTexture": false,
        "alpha": 50,
        "coneOrigin": 1,
        "loopAnimations": true
      }
    },
    "siftoolkit": {
      "SIFData": {
        "ignoreDuration": false,
        "texture": "",
        "useTexture": false,
        "alpha": 50,
        "coneOrigin": 1,
        "loopAnimations": true,
        "playTemplateAudio": false,
        "playDamageAudio": false,
        "clip": "",
        "volume": 100
      }
    },
    "midi-qol": {
      "onUseMacroName": "",
      "effectActivation": false,
      "forceCEOff": true,
      "forceCEOn": true
    },
    "link-item-resource-5e": {
      "resource-link": "primary"
    },
    "midiProperties": {
      "nodam": false,
      "fulldam": false,
      "halfdam": false,
      "rollOther": false,
      "critOther": false,
      "magicdam": false,
      "magiceffect": false,
      "concentration": false,
      "toggleEffect": false
    },
    "autoanimations": {
      "version": 4,
      "killAnim": true,
      "animLevel": false,
      "options": {
        "ammo": false
      },
      "override": false,
      "sourceToken": {
        "enable": false
      },
      "targetToken": {
        "enable": false
      },
      "levels3d": {
        "type": ""
      },
      "macro": {
        "enable": false
      },
      "audio": {
        "a01": {
          "enable": false
        }
      }
    },
    "gm-notes": {}
  }
}